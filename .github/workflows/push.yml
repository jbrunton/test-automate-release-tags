on: push

jobs:

  info:

    runs-on: ubuntu-latest
    env:
      THIS_RELEASE: ${{ github.event.release.name }}
    steps:
      - uses: actions/checkout@v2
        
      - name: get latest release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          LATEST_RELEASE=$(hub release | grep -E '^[0-9]+.[0-9]+.[0-9]+$' | sort -r | head -n 1)
          echo "latest release: $LATEST_RELEASE"
          echo ::set-env name=LATEST_RELEASE::$LATEST_RELEASE
          
      - env:
          JOBS_ENV: ${{ toJson(jobs.info.env) }}
          STEPS_ENV: ${{ toJson(jobs.info.steps.env) }}
        run: |
          echo "JOBS_ENV: $JOBS_ENV"
          echo "STEPS_ENV: $STEPS_ENV"
          
